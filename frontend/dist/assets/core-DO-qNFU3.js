function s(n,e,i,t){if(typeof e=="function"?n!==e||!t:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?t:i==="a"?t.call(n):t?t.value:e.get(n)}function c(n,e,i,t,_){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,i),i}var o,r,a,l,u;const d="__TAURI_TO_IPC_KEY__";function p(n,e=!1){return window.__TAURI_INTERNALS__.transformCallback(n,e)}class w{constructor(e){o.set(this,void 0),r.set(this,0),a.set(this,[]),l.set(this,void 0),c(this,o,e||(()=>{})),this.id=p(i=>{const t=i.index;if("end"in i){t==s(this,r,"f")?this.cleanupCallback():c(this,l,t);return}const _=i.message;if(t==s(this,r,"f")){for(s(this,o,"f").call(this,_),c(this,r,s(this,r,"f")+1);s(this,r,"f")in s(this,a,"f");){const f=s(this,a,"f")[s(this,r,"f")];s(this,o,"f").call(this,f),delete s(this,a,"f")[s(this,r,"f")],c(this,r,s(this,r,"f")+1)}s(this,r,"f")===s(this,l,"f")&&this.cleanupCallback()}else s(this,a,"f")[t]=_})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(e){c(this,o,e)}get onmessage(){return s(this,o,"f")}[(o=new WeakMap,r=new WeakMap,a=new WeakMap,l=new WeakMap,d)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[d]()}}class g{constructor(e,i,t){this.plugin=e,this.event=i,this.channelId=t}async unregister(){return h(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function m(n,e,i){const t=new w(i);return h(`plugin:${n}|registerListener`,{event:e,handler:t}).then(()=>new g(n,e,t.id))}async function I(n){return h(`plugin:${n}|check_permissions`)}async function C(n){return h(`plugin:${n}|request_permissions`)}async function h(n,e={},i){return window.__TAURI_INTERNALS__.invoke(n,e,i)}function T(n,e="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(n,e)}class k{get rid(){return s(this,u,"f")}constructor(e){u.set(this,void 0),c(this,u,e)}async close(){return h("plugin:resources|close",{rid:this.rid})}}u=new WeakMap;function E(){return!!(globalThis||window).isTauri}export{w as Channel,g as PluginListener,k as Resource,d as SERIALIZE_TO_IPC_FN,m as addPluginListener,I as checkPermissions,T as convertFileSrc,h as invoke,E as isTauri,C as requestPermissions,p as transformCallback};
